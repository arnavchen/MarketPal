@page
@model MarketPal.Web.Pages.IndexModel
@{
    ViewData["Title"] = "Welcome";
}

<section class="hero">
    <div class="hero-inner">
        <h1>Welcome to MarketPal</h1>
        <p class="lead">A small educational site to learn stock-market basics and .NET web development.</p>
        <p><a class="btn btn-primary" href="/About">Learn more</a></p>
    </div>
</section>

<section class="content-grid mt-4">
    <article class="card">
        <h3>Learn indicators</h3>
        <p>Explore moving averages, volatility, and simple trend signals with demo data.</p>
    </article>
    <article class="card">
        <h3>Visualize trends</h3>
        <p>Interactive charts help you see how indicators evolve over time.</p>
    </article>
    <article class="card">
        <h3>Educational only</h3>
        <p>This site is for learning — it does not provide financial advice.</p>
    </article>
</section>

<section class="mt-4 container">
    <div class="card p-3">
        <h3>Market Tracker (Demo)</h3>
        <div class="tracker-grid mt-3">
            <div class="p-3">
                <h5 class="mb-1">@Model.Symbol</h5>
                <p class="mb-1"><strong>Latest Close:</strong> @Model.LatestClose?.ToString("C") ?? "—"</p>
                <p class="mb-1"><strong>MA50:</strong> @Model.MA50?.ToString("C") ?? "—"</p>
                <p class="mb-1"><strong>MA200:</strong> @Model.MA200?.ToString("C") ?? "—"</p>
                <p class="mb-1"><strong>Signal:</strong> <span class="signal @Model.SignalClass">@Model.SignalLabel</span></p>
                <p class="mb-1"><strong>Volatility (ann.):</strong> @Model.VolatilityPercent?.ToString() ?? "—" %</p>
                <p class="mb-1"><strong>MA50 slope (10d):</strong> @Model.MA50SlopePercent?.ToString() ?? "—" %</p>
                <p class="mb-1"><strong>30d low / high:</strong> @Model.RecentLow?.ToString("C") ?? "—" / @Model.RecentHigh?.ToString("C") ?? "—"</p>

                <div class="mt-3">
                    <h5>Recommendation</h5>
                    <p class="@Model.RecommendationClass">@Model.RecommendationText</p>
                </div>
            </div>

            <div class="chart-card card p-2">
                <canvas id="homePriceChart" style="width:100%;height:100%;"></canvas>
            </div>
        </div>
    </div>

    <script>
        const homeTracker = {
            labels: @Html.Raw(System.Text.Json.JsonSerializer.Serialize(Model.Labels)),
            prices: @Html.Raw(System.Text.Json.JsonSerializer.Serialize(Model.Prices)),
            ma50: @Html.Raw(System.Text.Json.JsonSerializer.Serialize(Model.MA50Series)),
            ma200: @Html.Raw(System.Text.Json.JsonSerializer.Serialize(Model.MA200Series))
        };
        window.addEventListener('DOMContentLoaded', function () {
            if (typeof renderStockChart === 'function') {
                renderStockChart('homePriceChart', homeTracker.labels, homeTracker.prices, homeTracker.ma50, homeTracker.ma200);
            }
        });
    </script>
</section>

